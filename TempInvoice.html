<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Invoice 1.0</title>

  <style>
    :root{
      --ink:#444;
      --line:#777;
      --light:#777;
      --thin:1px;
      --radius:10px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:#fff;
      font-family: system-ui, -apple-system, "Segoe UI", Tahoma, Arial, sans-serif;
      color:var(--ink);
    }
    .page{
      max-width:980px;
      margin:0 auto;
      padding:20px 22px 28px;
    }

    /* ================= HEADER (FINAL) ================= */
    .invoice-header{ margin: 0 auto 18px; }

    .hdr-row{
      display:grid;
      grid-template-columns:1fr 1.2fr 1fr;
      align-items:end;
      direction:ltr; /* lock positions */
    }
    .hdr-left{justify-self:start;}
    .hdr-center{justify-self:center; text-align:center;}
    .hdr-right{justify-self:end; direction:rtl;}

    .logo{
      width:220px;
      height:auto;
      display:block;
      margin:0 auto 8px;
    }
    .invoice-badge{
      display:inline-block;
      border:1px solid var(--line);
      border-radius:8px;
      padding:4px 18px;
      font-weight:700;
      line-height:1.1;
    }
    .invoice-badge small{
      display:block;
      font-weight:600;
      opacity:.9;
    }

    .inv-no{
      border:0;
      outline:none;
      background:transparent;
      font-size:20px;
      font-weight:800;
      color:#d00;
      width:90px;
      direction:ltr;
    }
    .date-en,.date-ar{
      border:0;
      outline:none;
      background:transparent;
      font-size:16px;
      padding:0;
    }
    .date-en{direction:ltr; width:180px;}
    .date-ar{direction:rtl; text-align:right; width:220px;}

    .row-2{margin-top:8px;}
    .row-3{
      grid-template-columns:1fr;
      margin-top:18px;
    }
    .name-line{
      display:flex;
      align-items:center;
      gap:12px;
    }
    .mrms{min-width:70px; direction:ltr; white-space:nowrap;}
    .req{min-width:210px; font-weight:600; direction:rtl; white-space:nowrap;}
    .name-input{
      flex:1;
      min-width:0;
      border:0;
      border-bottom:1px dotted var(--line);
      outline:none;
      background:transparent;
      padding:4px 8px 2px;
      font-size:18px;
      font-weight:700;
      direction:rtl;
      text-align:right;
    }

    /* ================= ITEMS (Description + Qty) ================= */
   .items-box{
  margin-top:22px;
  border:1px solid #777;
  border-radius:10px;
  overflow:hidden;
}

.items-table{
  width:100%;
  border-collapse:collapse;
  table-layout:fixed;
}

.items-table th,
.items-table td{
  border-bottom:1px solid #777;
  padding:10px 8px;
  font-size:13px;
}

.items-table tr:last-child td{
  border-bottom:none;
}

/* Column widths (paper-like) */
.col-total{width:15%;}
.col-unit{width:15%;}
.col-qty{width:10%;}
.col-uniti{width:10%;}

.col-desc{width:50%;}

/* Header bilingual stack */
.th-stack{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:2px;
  line-height:1.1;
}
.th-stack .ar{
  font-weight:700;
}
.th-stack .en{
  font-size:12px;
  color:#777;
  direction:ltr;
}

/* Inputs – clean like printed form */
.items-table input{
  width:100%;
  border:0;
  outline:none;
  background:transparent;
  font-size:14px;
}

.qty{
  text-align:center;
  direction:ltr;
  font-variant-numeric: tabular-nums;
}

.money{
  text-align:center;
  direction:ltr;
  font-variant-numeric: tabular-nums;
}

.desc{
  direction:rtl;
  text-align:right;
}

    /* ================= TOTALS (Big text + small amount) ================= */
    .summary-wrap{
      margin-top: 22px;
      border:1px solid var(--line);
      border-radius: var(--radius);
      overflow:hidden;
    }

    /* LEFT big text | RIGHT small amount */
    .summary-row{
      display:grid;
      grid-template-columns: 1fr 120px;
      border-top:1px solid var(--line);
      direction:ltr;
      align-items:stretch;
    }
    .summary-row:first-child{border-top:none;}

    .summary-text{
      padding:10px 12px;
      display:flex;
      align-items:center;
    }
    .summary-text input{
      width:100%;
      border:0;
      outline:none;
      background:transparent;
      font-size:13px;
      direction:ltr;
    }

    .summary-amount{
      border-left:1px solid var(--line);
      padding:10px 8px;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .summary-amount input{
      width:100%;
      max-width:90px;
      border:0;
      outline:none;
      background:transparent;
      text-align:center;
      direction:ltr;
      font-weight:700;
      font-variant-numeric: tabular-nums;
    }

    @media print{
      .page{padding:0}
    }

/* ================= FOOTER ================= */
/* shared width container */
.invoice-bottom{
  width: 100%;
}

/* totals already fill container */
.summary-wrap{
  width: 100%;
}

/* footer centered but SAME WIDTH */
.invoice-footer{
  margin-top: 18px;
  display: flex;
  justify-content: center;
}

.footer-box{
  width: 100%;                 /* EXACT same width */
  border: 1px solid #777;
  border-radius: 14px;
  padding: 14px 20px;
  text-align: center;
  font-size: 12px;
  line-height: 1.6;
  color: #555;
}

  </style>
</head>



<script>
document.addEventListener('DOMContentLoaded', () => {
  const raw = localStorage.getItem('invoiceData');
  if (!raw) return;

  let data;
  try { data = JSON.parse(raw); } catch { return; }

  // تعبئة الهيدر (كما هو عندك)
  const setByName = (name, val) => {
    const el = document.querySelector(`[name="${name}"]`);
    if (el) el.value = val ?? '';
  };
  setByName('invoiceNo', data.invoiceNo);
  setByName('dateAr', data.dateAr);
  setByName('dateEn', data.dateEn);
  setByName('customerName', data.customerName);

  // ====== ✅ ITEMS (FIXED MAPPING) ======
  // Invoice row inputs order: [TotalPrice, UnitPrice, Qty, Unit, Desc]
  const rows = Array.from(document.querySelectorAll('.items-table tbody tr'));
  const items = Array.isArray(data.items) ? data.items : [];

  rows.forEach((tr, i) => {
    const inputs = tr.querySelectorAll('input');
    if (inputs.length < 5) return;

    const item = items[i] || {};

    // ✅ map from INDEX payload (desc, unit, qty, unitPrice, totalPrice)
    inputs[0].value = item.totalPrice ?? '';  // Total Price
    inputs[1].value = item.unitPrice  ?? '';  // Unit Price
    inputs[2].value = item.qty        ?? '';  // Qty
    inputs[3].value = item.unit       ?? '';  // Unit
    inputs[4].value = item.desc       ?? '';  // Description
  });

  // totals + texts (كما هو)
  const setById = (id, val) => {
    const el = document.getElementById(id);
    if (el) el.value = val ?? '';
  };

  const totals = data.totals || {};
  setById('sumTotal', Number(totals.total || 0).toLocaleString('en-US', { minimumFractionDigits: 1, maximumFractionDigits: 1  }));
  //setById('sumTotal', totals.total ?? '0.00');
  setById('sumDelivery', Number(totals.delivery || 0).toLocaleString('en-US', { minimumFractionDigits: 1, maximumFractionDigits: 1  }));
  //setById('sumDelivery', totals.delivery ?? '0.00');
  setById('sumGrand', Number(totals.grand || 0).toLocaleString('en-US', { minimumFractionDigits: 1, maximumFractionDigits: 1  }));
 // setById('sumGrand', totals.grand ?? '0.00');

  const texts = data.texts || {};
  setById('extraText1', texts.t1 ?? '');
  setById('extraText2', texts.t2 ?? '');
  setById('extraText3', texts.t3 ?? '');
});
</script>







<body>
  <div class="page">

    <!-- ================= HEADER ================= -->
    <header class="invoice-header">
      <div class="hdr-row">
        <div class="hdr-left">
          <span>No:</span>
          <input class="inv-no" name="invoiceNo" value="1099" />
        </div>

        <div class="hdr-center">
          <img src="logo.svg" class="logo" alt="Logo" />
          <div class="invoice-badge">
            <small>الفاتورة</small>
            Invoice
          </div>
        </div>

        <div class="hdr-right">
          <span>التاريخ</span>
          <input class="date-ar" name="dateAr" value="١٢ / ٦ / ١٤٤٧ هـ" />
        </div>
      </div>

      <div class="hdr-row row-2">
        <div class="hdr-left">
          <span>Date</span>
          <input class="date-en" name="dateEn" value="13 / 12 / 2025" />
        </div>
        <div></div>
        <div></div>
      </div>

      <div class="hdr-row row-3">
        <div class="name-line">
          <span class="mrms">Mr./Ms.</span>
          <input class="name-input" name="customerName" value="اسم العميل" />
          <span class="req">المطلوب من المحترم/</span>
        </div>
      </div>
    </header>

    
<!-- ================= ITEMS SECTION (FINAL – AR / EN) ================= -->
<section class="items-box" aria-label="Invoice Items">
  <table class="items-table">
    <thead>
      <tr>
        <th class="col-total">
          <div class="th-stack">
            <span class="ar">القيمة الإجمالية</span>
            <span class="en">Total Price</span>
          </div>
        </th>
        <th class="col-unit">
          <div class="th-stack">
            <span class="ar">السعر الإفرادي</span>
            <span class="en">Unit Price</span>
          </div>
        </th>
        <th class="col-qty">
          <div class="th-stack">
            <span class="ar">العدد</span>
            <span class="en">Qty</span>
          </div>
        </th>
        <th class="col-uniti">
          <div class="th-stack">
            <span class="ar">الوحدة</span>
            <span class="en">Unit</span>
          </div>
        </th>
        <th class="col-desc">
          <div class="th-stack">
            <span class="ar">البيان</span>
            <span class="en">Items / Description</span>
          </div>
        </th>
      </tr>
    </thead>

    <tbody>
      <!-- fixed clean rows (like paper form) -->
      <tr>
        <td><input class="money" /></td>
        <td><input class="money" /></td>
        <td><input class="qty" /></td>
        <td><input class="desc" /></td>
        <td><input class="desc" /></td>
      </tr>
      <tr>
        <td><input class="money" /></td>
        <td><input class="money" /></td>
        <td><input class="qty" /></td>
        <td><input class="desc" /></td>
        <td><input class="desc" /></td>
      </tr>
      <tr>
        <td><input class="money" /></td>
        <td><input class="money" /></td>
        <td><input class="qty" /></td>
        <td><input class="desc" /></td>
        <td><input class="desc" /></td>
      </tr>
      <tr>
        <td><input class="money" /></td>
        <td><input class="money" /></td>
        <td><input class="qty" /></td>
        <td><input class="desc" /></td>
        <td><input class="desc" /></td>
      </tr>
      <tr>
        <td><input class="money" /></td>
        <td><input class="money" /></td>
        <td><input class="qty" /></td>
        <td><input class="desc" /></td>
        <td><input class="desc" /></td>
      </tr>
    </tbody>
  </table>
</section>



<!-- ================= TOTALS + TEXTS (FINAL FIXED ALIGNMENT) ================= -->
<div class="summary-wrap">

  <!-- ROW 1 -->
  <div class="summary-row">
    <div class="summary-text" style="direction:rtl; justify-content:space-between; gap:12px;">
      <!-- RIGHT: caption -->
      <div style="text-align:right; white-space:nowrap;">
        <strong>المجموع</strong><br>
        <small>Total</small>
      </div>

      <!-- LEFT: additional text -->
      <input id="extraText1" placeholder="نص إضافي 1"
             style="border:0; outline:none; background:transparent; text-align:right; flex:1;">
    </div>

    <div class="summary-amount">
      <input id="sumTotal" value="0.00">
    </div>
  </div>

  <!-- ROW 2 -->
  <div class="summary-row">
    <div class="summary-text" style="direction:rtl; justify-content:space-between; gap:12px;">
      <!-- RIGHT: caption -->
      <div style="text-align:right; white-space:nowrap;">
        <strong>التوصيل</strong><br>
        <small>Delivery</small>
      </div>

      <!-- LEFT: additional text -->
      <input id="extraText2" placeholder="نص إضافي 2"
             style="border:0; outline:none; background:transparent; text-align:right; flex:1;">
    </div>

    <div class="summary-amount">
      <input id="sumDelivery" value="0.00">
    </div>
  </div>

  <!-- ROW 3 -->
  <div class="summary-row">
    <div class="summary-text" style="direction:rtl; justify-content:space-between; gap:12px;">
      <!-- RIGHT: caption -->
      <div style="text-align:right; white-space:nowrap;">
        <strong>إجمالي المبلغ</strong><br>
        <small>Total</small>
      </div>

      <!-- LEFT: additional text -->
      <input id="extraText3" placeholder="نص إضافي 3"
             style="border:0; outline:none; background:transparent; text-align:right; flex:1;">
    </div>

    <div class="summary-amount">
      <input id="sumGrand" value="0.00">
    </div>
  </div>

</div>


<!-- ================= FOOTER ================= -->
<div class="invoice-bottom">
  <footer class="invoice-footer">
    <div class="footer-box">
      <div class="footer-ar">الرياض - المملكة العربية السعودية</div>
      <div class="footer-en">Riyadh - Kingdom of Saudi Arabia</div>
      <div class="footer-mob">Mob: +966 59 209 8088</div>
    </div>
  </footer>
</div>





</body>
</html>

